# Backend environment template (covers all env vars used by the backend)
# Copy to backend/.env and adjust values.

# Core server
# Runtime environment label used by the backend and worker (development or production).
NODE_ENV=development
# Port for the Fastify server.
BACKEND_PORT=8080
# Comma-separated CORS allowlist for the frontend origins.
ALLOWED_ORIGINS=http://localhost:3000
# Log verbosity (INFO, WARNING, ERROR).
LOG_LEVEL=INFO
# Disable the scheduler loop when running a separate worker.
DISABLE_SCHEDULER=false

# Simulation mode: simulated | realtime | historical | hybrid
# Primary simulation mode.
MODE=simulated
# Start date for historical or hybrid mode (YYYY-MM-DD).
HISTORICAL_SIMULATION_START_DATE=2025-01-06
# End date for historical or hybrid mode (YYYY-MM-DD, optional).
HISTORICAL_SIMULATION_END_DATE=
# Override start date used by simulated mode (ISO date string).
SIMULATED_START_DATE=
# Auto-stop after this many simulation days (leave blank for no auto-stop).
MAX_SIMULATION_DAYS=

# LLM provider (required if ENABLE_LLM=true)
# OpenRouter API key for LLM calls.
OPENROUTER_API_KEY=sk-or-v1-your-key-here
# Toggle LLM calls (false uses synthetic trades).
ENABLE_LLM=true
# Force all agents to use the same model.
USE_UNIFIED_MODEL=false
# Model identifier when USE_UNIFIED_MODEL=true.
UNIFIED_MODEL=google/gemini-2.5-flash-lite
# Use simplified prompts to reduce token usage.
SIMPLE_BOT_PROMPTS=false

# Simulation intervals (milliseconds)
# Price tick interval for simulated/historical modes.
SIM_INTERVAL_MS=30000
# Trade decision interval for simulated/historical modes.
TRADE_INTERVAL_MS=7200000
# Market minutes advanced per tick in historical mode.
SIM_MARKET_MINUTES_PER_TICK=30
# Price tick interval for realtime mode.
REALTIME_SIM_INTERVAL_MS=600000
# Trade decision interval for realtime mode.
REALTIME_TRADE_INTERVAL_MS=1800000
# Export interval for scheduled data exports.
EXPORT_INTERVAL_MS=86400000

# LLM pacing (milliseconds)
# Fixed delay between LLM calls; set -1 to disable.
LLM_REQUEST_SPACING_MS=-1
# Minimum spacing when auto spacing is enabled.
LLM_MIN_REQUEST_SPACING_MS=0
# Auto-derive spacing from simulation interval.
LLM_AUTO_SPACING=false
# Cap concurrent LLM requests; 0 means unlimited.
LLM_MAX_CONCURRENT_REQUESTS=0

# Market data
# Use delayed data to reduce rate limits in realtime mode.
USE_DELAYED_DATA=false
# Delay window in minutes when USE_DELAYED_DATA=true.
DATA_DELAY_MINUTES=30
# Enrich Yahoo data with detailed info on initial load.
ENABLE_YAHOO_DETAILED_INFO=false
# Alpha Vantage API key (fallback source).
ALPHA_VANTAGE_API_KEY=
# Polygon API key (fallback source).
POLYGON_API_KEY=
# Clamp intraday price jumps above this fraction (0.2 = 20%).
MAX_PRICE_JUMP_PERCENT=0.2
# Guard window for realtime fetch batching.
REALTIME_FETCH_GUARD_MS=5000
# Batch size for realtime fetch.
REALTIME_FETCH_BATCH_SIZE=8
# Minimum pause between realtime fetch batches.
REALTIME_FETCH_MIN_PAUSE_MS=150
# Guard window for prefetch batches.
PREFETCH_GUARD_MS=1000
# Batch size for prefetching.
PREFETCH_BATCH_SIZE=25

# Simulation control
# Reset simulation state on startup.
RESET_SIMULATION=false
# Save historical snapshot for realtime preload.
SAVE_HISTORICAL_PRELOAD=true
# Load historical snapshot when entering realtime.
REALTIME_PRELOAD_HISTORICAL=false
# Snapshot ID used for historical preload.
HISTORICAL_PRELOAD_SNAPSHOT_ID=historical-preload
# Autosave interval for snapshots (milliseconds).
SNAPSHOT_AUTOSAVE_INTERVAL_MS=900000

# Chat
# Toggle chat messages in prompt-strategy simulations.
CHAT_ENABLED=true
# Max chat messages per agent per round.
CHAT_MAX_MESSAGES_PER_AGENT=3
# Max chat messages per user per round.
CHAT_MAX_MESSAGES_PER_USER=2
# Max chat message length in characters.
CHAT_MESSAGE_MAX_LENGTH=140

# Trading universe
# Limit number of tickers used in the simulation.
ARENA_TICKER_COUNT=
# Custom comma-separated ticker list (overrides default list).
S_P500_TICKERS=

# Trading fees
# Trading fee in basis points.
TRADING_FEE_BPS=5
# Minimum fee per trade in dollars.
MIN_TRADE_FEE=0.25

# Persistence
# Persistence driver (file or postgres).
PERSISTENCE_DRIVER=file
# Snapshot file path for file persistence.
PERSIST_PATH=./data/snapshot.json
# Postgres connection string (alternative to DATABASE_URL).
POSTGRES_URL=
# Postgres connection string (alternative to POSTGRES_URL).
DATABASE_URL=
# Use SSL for Postgres connections.
POSTGRES_SSL=true
# Namespace used to isolate snapshots in Postgres.
POSTGRES_NAMESPACE=default
# Snapshot ID used in Postgres.
POSTGRES_SNAPSHOT_ID=current

# Worker heartbeat
# Interval for worker heartbeat logs (milliseconds).
HEARTBEAT_INTERVAL_MS=300000

# Simulation type toggles (optional; default true when unset)
# Toggle the multi-model simulation type.
SIM_ENABLE_MULTI_MODEL=
# Toggle the model-sizes simulation type.
SIM_ENABLE_MODEL_SIZES=
# Toggle the prompt-strategies simulation type.
SIM_ENABLE_PROMPT_STRATEGIES=
# Toggle the blind-test simulation type.
SIM_ENABLE_BLIND_TEST=
